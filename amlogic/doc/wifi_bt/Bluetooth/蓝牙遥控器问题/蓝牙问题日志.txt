


2017.1.5

    最新一轮测试完成，主要是回连需再次验证测试，其他问题录bug系统后续改进。

    用最新的host库重新打包开始回连问题验证测试，修复拔电池 需要20s才能回连的问题。修复配对apk无法配对问题。

2017.01.05
   现在的Remote001及Remote006 蓝牙遥控器与普通红外遥控器无法区分，后续要加上丝印区分。

2017.1.4
   遥控器更新连接需要4S才能使用的问题.

   发现 待机唤醒不能回连问题，在高级设置中断开蓝牙连接，遥控器和机顶盒静置几分钟后不能回连. (后更新host 库解决)

   描述如下：

	一、使用遥控器方提供的SO和APK：
		
	1.在setting里面手动断开连接，之后按遥控器键可以回连，但setting不会显示已连接。

	2.在setting里面手动断开连接，静置2分钟或更久，不能按遥控器键回连了，而且测试按组合键也不会弹出配对向导

	3.正常连接时拔遥控器电池，再装上电池，setting 连接状态会从连接变为不显示连接，此时再按遥控器按键不能回连。


	二、不使用该SO和APK：如果在系统设置里手动断开连接，遥控器就100%不能再自动回连。

        出现问题时，鼠标点击链接是可以重新回连，重启也可以回连


2016.12.30

    静置回连不了，一天出现2次，但后面发现该问题概率较低，host端认为增加了遥控器方的驱动，导致log不对，无法分析。只能下次出现问题时，再根据log分析。


   用最新软件重新开始新一轮的全新功能测试，软件采用遥控器方提供的库及apk。

   修正以下功能
   1.待机重启，遥控需要１０ｓ才可以使用
   2.待机唤醒后不能用
   3.显示已连接，但遥控器不能用
   4.蓝牙唤醒后只有power及鼠标功能可用
   


2016.12.29
   待机无法唤醒
   蓝牙唤醒后只有power及鼠标功能可用
   待机唤醒后隔30秒左右盒子会自动唤醒一下然后又待下去

2016.12.28
    刘竹星在测试时发现偶尔待机下去唤醒不了，有时唤醒了只能用鼠标

2016.12.27

   发现以下问题：
   1.使用遥控器方提供的需求，连接后需要4s才能使用的问题。
   2.异常不是使用遥控器时，按组合键也是不能启动重新配对的
   3.把apk设置为隐藏模式 
   4.现在断电重启要6秒，如再增加加遥控器方的驱动要9秒！

2016.12.26


1、遥控器显示已连接但是无法操作。
    有三种现象：见下述列举的Ａ、Ｂ、Ｃ三点
 A、配对完成后立刻就不能用；
    　复现方法：
    　 在Amlogic setting 取消配对（unpair），配对APK 随后会弹出，按遥控器双键重新配对，显示已连接但是遥控器无法操作（打印”已连接却无法使用.rar“），这个问题是不是就是“hid描述丢掉的问题”？
     　这个早两个礼拜有带过问题样机给启望分析，启望后面再试验过程中发现现象变为未连接，后面遥控器重新配对使用了，现象不存在了。
　　分析情况：
　　【SDMC】  该问题重复测试14次重现，且出现问题时再次按遥控器配对键也不能启动配对！ 
　　　　　　　　出现问题后重启也不能解决问题。
　　　      　　     按双键之后再重启，也还是显示已连接，一定要用鼠标清除盒子配对才能解决。
　　　        　　   此时是有使用驱动” 020080-申议-SRC1205-BLE-驱动-V03R01-20161214(1).rar  “。该驱动没生效？
　　【 ampak】 1.log抓的有点问题。
               　　　   
 　　【SDMC】   log C11是直接从盒子里面拷出来的不知道为什么会是空的，我们再重新抓log
                该问题为我们的自动配对apk主动连接导致的，apk去掉该功能，问题解决。

Ｂ、配对完成后，机顶盒断电重启不能用，只出现一次；
Ｃ、待机唤醒后不能用，出现以后现在很容易出现，断电后也不能用 ；
　　【SDMC】
　　　　　　打印见附件。
　　　　　　出现问题后，拔掉遥控器电池，显示未连接，再 装上电池由会显示已连接，但遥控器就是不能用！
　　　　　　后面按键没反应看下RC有没有送键值
　　【 ampak】配对资讯是完整的，log最后都没连接上，需要抓包


2、遥控器回连不了，显示已配对未连接，遥控器不能用！
          机顶盒待机一晚上, 用前面板按键唤醒后发现蓝牙遥控不能回连！setting显示已配对，未连接。(打印”机顶盒待机一晚上后唤醒，蓝牙遥控不能回连.rar“)
【SDMC】  出现该问题后，再次按遥控器配对键也不能启动配对！
                         但按双键后重启机顶盒会重新弹出蓝牙配对向导弹出，配对后可以使用（估计是按双键要重启才起作用）。

【 ampak】2.从log看在待机之前RC发了disconnect后host的配对信息被删除了。
                 
                    想请问下，待机之前是否RC没做什么操作，只是盒子待机。如果是这样晚点我给个patch给郭工再试下。
【SDMC】待机之前没有做异常操作，没有发出disconnect信息。（如果发出了disconnect信息蓝牙配对向导会自动弹出然后自动回连遥控，不会出现无法操作的问题）
                    待机之前没做什么操作，直接是按的遥控器power 键待机的
【 ampak】待机前，遥控器有发一个没加bg的disconnect，发了这种case的disconnect后没没加bg host就不会回连，陈工会发个patch在这种情况下也可以回连，但根本问题是遥控器方的disconnect有问题

【SDMC】为待机apk 暴力杀了蓝牙服务导致，修正待机apk功能，待验证。


３、待机重启，遥控需要１０ｓ才可以使用
            我们与Ampak这边确认
４、连键问题
    　严工这边帮忙确认。



2016.12.23

    遥控器不能回连问题测试两周，没复现问题，新软件测试的问题有：

     1.恢复出厂，配对遥控器后，开机向导会退到后台
          -----柳先明验证为收到home键所致，但这个问题没有影响，工厂会先配对好遥控器，用户开机时开机向导可以弹出
     2.重启式待机有时唤醒不了
           -----直接改为只支持断按待机的，杨卓勋
     3.待机后，任意键可唤醒，或概率性待机不了，
	-----杨宇峰


  4.连键问题---后辰奕割遥控器天线处理，问题得到很大改善。
  5.配对过程中再次按配对键导致的异常不能使用问题,如果能修改成此时再次按双键能启动配对也是可以接受的！---后修改为配对时不响应组合键解决。
  6.待机起来后需要10s才能链接，断电开机没有这个问题
  

 


  辰奕提供：“20080-申议-SRC1205-BLE-驱动-V03R01-20161214(1).rar ” 驱动解决对码后hid描述丢掉问题，驱动不影响模拟鼠标的使用


2016.12.21~22
	启望提供新的按组合键可以重新配对的遥控器软件。修复清除配对后需松开组合键再按才能配对

2016.12.20

    催促遥控器方提供解决方案，目的是：当遥控器不能正常使用时，通过按遥控器双键能重新启动遥控器配对流程，从而使得遥控器可用。 

    方案一、
         同时按下双键3秒后，
        1) 发送清配对回连广播------------以便HOST端根据该指令会清除HOST端自身的配对信息 
        2) 发送非定向配对广播-----------盒子端可以根据该指令开始新的配对 
          目前该方案反馈无法实现。
     

    方案二、 
             同时按下双键3秒后，
        1）遥控器能清除自身配对 
        2）遥控器可以发出回连广播------------HOST根据该指令会清除HOST自身的配对信息 
        3）遥控器可以发出非定向配对广播------盒子端根据该指令可以开始新的配对 
        以上3个动作最好是能连续发出，避免用户多次按键，实在不行只能让用户多次按键了。

    这些方案主要依赖下列特性：
   HOST端特性：如果遥控器这边清除了自身的配对，那么在按下任意键后发的回连广播，盒子端收到后会把自己的配对也清掉。
 我们配对apk特性：只要盒子端把自身的配对信息清掉，我们的配对apk 应用就可以自动启动重新配对流程了。 
                   也可以不用我们的配对apk，直接进入盒子端的setting 界面启动重新配对，注意setting 有个bug，需要手动刷新下蓝牙配对信息才能刷新过来。 




2016.12.13
   蓝牙遥控器严工、王谦、ap6330 陈工一起来公司解决问题，定下以下事项：
   1.配对后遥控器不能用的问题不是回连问题，此时遥控器能连接而按键不起作用，该问题需陈工这边帮忙分析解决，启望这边有个APK 可以解决该类问题，支持按键响应，但不支持鼠标功能，可以发过来我们测试下。
   2.遥控器采用12.5ms的间隔，不清除配对，不休眠模式，明天启望发软件过来升级
   3.如果出现遥控器与盒子不能回连的异常情况，采用下列操作使得遥控器和机顶盒能重新配对：
      a、遥控器在同时按下双键3秒后，发送清配对回连广播，再发送非定向配对广播。
         目前清配对回连广播格式按照今天抓包的格式，启望尽快修改软件给我们测试。

      b、盒子端收到清配对回连广播后，清除盒子端的配对信息
	 目前该步骤有个问题，盒子端清除了配对信息，但高级设置仍然显示有配对信息，需要重新开关蓝牙才能刷新状态，这个我们找Amloigc解决

      c、盒子端配对apk 检查到配对信息清除，就弹出对码apk 提示用户重新配对。
      d、重新启动配对流程。完成遥控器配对。

   4.这两天辰奕、启望、陈工这边都用我们提供的盒子测试下遥控器回连问题，如果发现问题，再一起分析解决。
     我们这边会使用带串口打印的遥控器重新现象，发现问题后抓遥控器log信息给启望分析。


2016.12.19

    我们这里总测试了8个1205遥控器，其中有三个很难被机顶盒扫描到。



2016.12.10
	由于蓝牙遥控器存在有时不能正常使用的问题，考虑增加一个功能清除遥控器配对，以便重新配对遥控器。

	考虑下这个方案是否可行：按住recovery键6秒清除可以自动清除遥控器配对。机器重启后可弹出配对apk。

2016.12.09：
	蓝牙遥控器问题目前情况如下：

1、今天用其他家的遥控器测试了一下回连问题，发现其他家遥控器出现问题的概率更高。具体情况如下：

      测试了三个盒子端软件（amlogic 公版、陈工释放的新库、郭金铭编译的库），4款遥控器（小米、天猫、funtv、sdmc ais款）：
    a、amlogic 公版软件：小米、天猫、funtv每次开机都100%出现不能回连现象，且此时底层显示有连接，而setting ui显示没连接。sdmc 遥控器无此问题。
    b、郭金铭编译的新库：小米、天猫、SDMC遥控器都有出现不能回连现象，且断电开机也不能回连。
          ap6330 陈工分析师读不到RC features，需要遥控器方抓包分析。遥控器方今天没有重现问题，抓不到包。

    c、陈工释放的新库：小米、天猫、funtv都有出现不能回连现象，且断电开机也不能回连。sdmc 遥控器暂时没重现该问题。

    另外，之前用浩博释放的蓝牙库也测试出我们sdmc 遥控器不能回连且断电不能回连的问题。（测试2天出现一次，一共出现4次左右）

2、 目前有两个软件用我们自己的遥控器还没出现过回连问题，请陈亮安排明天用我们的遥控器继续复现问题。
      出现问题后抓log发出来，下周一把出问题的板子及遥控器带去遥控器方抓包分析。
      这两个软件是： 公版软件 及    Dongle 软件 + 陈工释放的新库 。


2016.12.08：
  会议记录：
	概率性不能回连跟下面三个方面都有关系，已把三方抄送到邮件中解决问题：
   遥控器   、  蓝牙模组     、 Amlogic

  是主、从蓝牙设备的配合方面的问题。

  1.遥控器方面，换遥控器测试，用小米、天猫遥控器测试，配合第三方库测试，如果其他家遥控器没问题，就证明是我们遥控器问题。
    另外辰奕寄创维、华为量产的遥控器过来测试。
    我这边再找浩博要支持。

  2.蓝牙模组方面，郭金铭跟进陈工，推动他们分析解决

  3.原厂方面，郭金铭跟进amlogic最新的软件，看是否需要整合amlogic 及 模组厂家的代码，给出新软件测试验证。

  4.测试方面，陈亮考虑测试用例，针对回连问题，完善测试用例，提高检出回连问题的方法。
    参考辰奕给的必现的测试方法测试，验证遥控器的影响、蓝牙库的影响。


2016.12.07
     ap6330端支持积极，但辰奕严工说问题在host，不太配合修改问题。
     
     以下是沟通整理情况：S905 dongle AP6330模组，蓝牙遥控器目前还存在下列问题没有解决：

    1.遥控器存在概率性不能回连的问题，有时候是老化2天不出现，有时候放半小时就出现了，就是本来正常使用的遥控器过一段时间会无法使用。
        该问题不同的遥控器表现不一样：当盒子断电重启，有些蓝牙遥控器每次都不能回连，有些遥控器是概率性不能回连，遥控器厂家说这需要AMlogic更新软件，我们正在联系。
    2.按下蓝牙遥控器的两个对码键， 存储在遥控器中的配对信息会被清除，遥控器会无法使用.
      蓝牙模块厂家更新的代码还存在点问题，继续跟进，同步找amlogic要更新代码。
   3.盒子开机后需要等7~8秒才能使用遥控器，正常应该是1~2秒就可以用的。
     蓝牙模块厂家还没更新代码，amlogic说是遥控器问题！

   综上 遥控器问题跟遥控器及蓝牙模组软件都有关系，其中蓝牙模组代码amlogi和蓝牙模组厂家都可能会修改。
   AMLOGIC我来推进，蓝牙模组厂家郭金铭跟进！
   
2016.12.07
	辰奕返回遥控器测试结果，有很多回连问题。
        Remote006遥控器不能OTA升级，（后严工过来，发现是电池不足导致的问题。）	

2016.12.05
	用浩博高给的蓝牙库bluetooth.default.so能解决一些问题，但没有源码，已在进一步联系ap6330模组解决这些问题，已寄样机，发问题log。
        1、正常使用时再次按对码键导致遥控器不能用
        2、开机遥控器需要7秒才能用
        3、静置出现不能回连问题。


2016.12.01

    DV6065S订单测试，使用浩博高的host库，测试反馈这款遥控器存在不能使用的问题！出现两次了，不可接受，必须要修改！
     第一次：老化一晚上正常，蓝牙遥控不能回连，无法使用。
     第二次：蓝牙遥控静置1小时，遥控不能回连，，无法使用。鼠标点进高级设置，显示已配对但是断开了连接，鼠标点击可以再次连接

     另外这款遥控器还存在干扰wifi的问题，经过与蓝牙遥控器辰奕严工沟通了，确定以下事情：

1.蓝牙遥控器量产前需要经过详细修改测试的！
    这个测试跟具体的机器有关，换了机器修改了东西，需要再次重新测试的。已寄盒子给严工测试。
    我们需要寄一个Dongle 样机给他们，他们帮忙做量产测试，他说android系统的蓝牙有些稳定性的问题，

2.遥控器按配对双键后无法使用的回连问题跟他们遥控器无关，可能是bluetooth.default.so库的问题，估计是遥控器sleep后不能重连。
    
    解决开机后需要等7~8秒才能能使用遥控器的问题
    另外，还有下面的问题我也在找他们，他们需要我们提供log，郭金铭也支持一下：
           在andriod 5.1的系统setting 里打开蓝牙，不能发现蓝牙设备！要开关一次蓝牙才可发现刚刚被扫描到的蓝牙设备（收到BluetoothDevice.ACTION_FOUND 这个广播），这个问题大概是什么原因？

3.遥控器最终还是会改成按双键清除自身对码信息的方案。

    向李贵增反馈生产问题：

     带蓝牙遥控器的产品在工厂生产时需要进行蓝牙配对。
     目前这150台的dongle 产品在工厂测试阶段先配对遥控器进行测试，之后清除数据取消配对，最后组装之前再开机配对遥控器。

    上述方案比较耗费时间，比不带蓝牙的产品每台大概多花费1分多种，请看看业界其他厂家是否有优化方案，以便下次生产时提升生产效率。


2016.11.29
    AP6330陈工这边支持力度很大，我们反馈的问题都有回复。

    但浩博高的支持终止，因为发现Remote006遥控器不是使用的他们的方案！

    
2016-11-29

   目前看来蓝牙遥控器至少还存在下面的问题需要解决，如果这批订单来不及，下批也要改进：

1. 对码时间偏长，别人的只要几秒钟，一般不超过10秒，我们需要10~20秒，甚至更长。
   原因： 刘竹星说该问题是setting的问题，是扫到设备后需再开关一次蓝牙才能收到广播，而扫描一次至少需要10秒钟。
  
    解决：该问题反馈原厂解决吧，刘竹星跟进下。

   
2. 浩博工程师测试时对码时，一直出现对不上的情况，而且对码apk界面小时，需要重启才能重新弹出对码apk再次对码。
   原因：是我们的对码时间偏长，浩博工程师等不及多按了几次对码键，导致遥控器连接上后遥控器对码信息又被清掉。
   解决：该问题在用户家里还是很可能出现的，如果问题1 解决，这个问题就不太容易有机会出现，所以先解决问题1.

3.开机后，需要7~8秒钟蓝牙遥控器才生效，别人家的1~2秒就可以生效了。
  原因：蓝牙服务没起来？？ 
  解决：需要优化!
4.还有一个问题： 在andriod 5.1的系统setting 里打开蓝牙，不能发现蓝牙设备！要开关一次蓝牙才可发现刚刚被扫描到的蓝牙设备（收到BluetoothDevice.ACTION_FOUND 这个广播），这个问题大概是什么原因？



2016-11-28
     周工、陈亮拜访浩博高，学习测试经验、参观他们仿苹果的带触摸的遥控器。   

     辰奕说BT稳定性需要对贵司相应的box进行测试，请最好提供给我司测试，否则无法量产的

2016-11-25
     ap6330模块帮忙更新S905/S912的一些补丁。 
     Android 5.1代码：只需要提供bt部分的code即可。目录: /external/bluetooth/bluedroid/
     Android 6.0代码：目录 /system/bt/

2016-11-24 
     刘竹星反馈应用APK不能区分遥控器的异常连接和待机时的未连接，因而不能解决该问题。
     
     从浩博高得知Host 协议能解决该问题，他们给我们更新发了一个博通的蓝牙协议栈，对应模组ap6330　android5.1，更新日期是2016年10月 。

      该协议栈支持以下方案，需安排集成测试一下是否有效，如果有效再找broadcom要对应的协议栈，这个是杨宇峰这边的吧？
          如果遥控器之前与盒子正常配对了，而遥控器单方面清除了配对信息，那么盒子开机并按遥控器键时，蓝牙模块就能检查到异常，蓝牙模块会自动清      除该遥控器的配对信息，这样就能触发我们的蓝牙配对apk进行重新配对解决问题！


2016-11-23
    跟amlogic、AP6330段工、浩博高反馈此问题。

2016-11-15 
   得知DV6065S有个小订单。
   会议讨论蓝牙遥控器遗留问题：正常使用的蓝牙遥控器，如果再次按下了对码的两个按键 遥控器的对码信息就会被清除，遥控器就无法使用！！这种情  况只能用鼠标取消盒子端的蓝牙配对、并重新对码才能解决。
   会议决策用配对APK绕过此问题：1.检查盒子与遥控器有没有正常配对连接，如果不正常，弹出对码提示界面提示重新配对。  -----刘竹星负责，杨宇峰配合。


2016.11.18
    蓝牙wifi相互干扰，使用蓝牙遥控器，wifi吞吐量掉到20M（后修改间隔时间为12.5解决，该时间越大，遥控器响应越慢，对wifi干扰越小）